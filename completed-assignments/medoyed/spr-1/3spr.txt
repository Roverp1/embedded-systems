
ARG1	EQU	20h
ARG2	EQU	22h
SUB_R	EQU	25h
ROB	EQU	30h

	LJMP	START
	ORG	100H

START:
	LCALL	LCD_CLR
	MOV	DPTR, #TXT3
	LCALL	WRITE_TEXT
	
	MOV	R0, #ARG1
	LCALL	GET_NUM
	LCALL	BCD_HEX
	MOV	A, 21h
	JNZ	ERROR1
	MOV	A, ARG1
	RLC	A
	JC	ERROR1
	AJMP	CONT1

ERROR1:
	MOV	DPTR, #TXT_ERR
	LCALL	WRITE_TEXT
	LCALL	WAIT_KEY
	AJMP	START

CONT1:
	MOV	A, #'-'
	LCALL	WRITE_DATA
	
	MOV	R0, #ARG2
	LCALL	GET_NUM
	LCALL	BCD_HEX
	MOV	A, 23h
	JNZ	ERROR2
	MOV	A, ARG2
	RLC	A
	JC	ERROR2
	AJMP	CONT2

ERROR2:
	MOV	DPTR, #TXT_ERR
	LCALL	WRITE_TEXT
	LCALL	WAIT_KEY
	AJMP	START

CONT2:
	MOV	DPTR, #TXT1
	LCALL	WRITE_TEXT
	LCALL	WAIT_KEY
	LCALL	LCD_CLR
	
	MOV	A, ARG1
	ACALL	PISZ_HEX
	MOV	A, #'-'
	LCALL	WRITE_DATA
	MOV	A, ARG2
	ACALL	PISZ_HEX
	MOV	A, #'='
	LCALL	WRITE_DATA
	
	MOV	A, ARG1
	CLR	C
	SUBB	A, ARG2
	MOV	SUB_R, A
	
	JNB	ACC.7, E8
	MOV	A, #'-'
	LCALL	WRITE_DATA
	MOV	A, SUB_R
	CPL	A
	ADD	A, #1
	ACALL	PISZ_HEX
	SJMP	NEXT_LINE

E8:
	MOV	A, SUB_R
	ACALL	PISZ_HEX

NEXT_LINE:
	MOV	A, #0C0h
	LCALL	WRITE_INSTR

	ACALL	ZERUJ_ROB
	MOV	A, ARG1
	MOV	ROB, A
	MOV	R0, #ROB
	LCALL	HEX_BCD
	ACALL	PISZ_BCD
	MOV	A, #'d'
	LCALL	WRITE_DATA
	
	MOV	A, #'-'
	LCALL	WRITE_DATA
	
	ACALL	ZERUJ_ROB
	MOV	A, ARG2
	MOV	ROB, A
	MOV	R0, #ROB
	LCALL	HEX_BCD
	ACALL	PISZ_BCD
	MOV	A, #'d'
	LCALL	WRITE_DATA
	
	MOV	A, #'='
	LCALL	WRITE_DATA
	
	MOV	A, SUB_R
	JNB	ACC.7, E10
	MOV	A, #'-'
	LCALL	WRITE_DATA
	MOV	A, SUB_R
	CPL	A
	ADD	A, #1
	MOV	ROB, A
	SJMP	E11

E10:
	MOV	A, SUB_R
	MOV	ROB, A

E11:
	ACALL	ZERUJ_ROB_BCD
	MOV	R0, #ROB
	LCALL	HEX_BCD
	ACALL	PISZ_BCD
	MOV	A, #'d'
	LCALL	WRITE_DATA
	
	LCALL	WAIT_KEY
	LJMP	START

PISZ_HEX:
	LCALL	WRITE_HEX
	MOV	A, #'h'
	LCALL	WRITE_DATA
	RET

PISZ_BCD:
	MOV	A, ROB+1
	JZ	E3
	LCALL	WRITE_HEX
E3:
	MOV	A, ROB
	LCALL	WRITE_HEX
	RET

ZERUJ_ROB:
	CLR	A
	MOV	ROB, A
	MOV	ROB+1, A
	MOV	ROB+2, A
	RET

ZERUJ_ROB_BCD:
	CLR	A
	MOV	ROB+1, A
	MOV	ROB+2, A
	RET

TXT1:	DB	' klik ',0
TXT3:	DB	'Wpisz arg. <=127',0
TXT_ERR:	DB	' ERROR',0
	END